(function(b){b.stackGallery=function(d){function P(a){for(var c=0,e,f;c<h;c++)if(e=g[c],f=b(e).attr("id"),f==a)break;return e}function Q(){for(var a=0,c;a<h;a++)c=b(g[a]),c.unbind("click",A),c.css("cursor","default")}function A(a){if(!a)a=window.event;a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation();if(!j)return j=!0,r("off"),a=b(a.currentTarget).attr("id"),B(a),C(),!1}function B(a){a||(a=h-1);var c=P(a);Q();R(a);var a=Math.random()*(S-s)+s+"deg",e=Math.random()*(D-w)+w+"deg";i=="verticalAbove"|| i=="verticalRound"?b(c).animate({rotate:a,top:-E},{duration:t,easing:"easeOutCubic",complete:function(){g.unshift(g.pop());T(c);b(c).animate({rotate:e,top:0},{duration:m,easing:"easeOutExpo"});b(g[h-1]).animate({rotate:"0deg",duration:m,easing:"easeOutExpo"});o&&clearTimeout(o);o=setTimeout(U,m)}}):b(c).animate({rotate:a,left:i=="horizontalLeft"?-u:u},{duration:t,easing:"easeOutCubic",complete:function(){g.unshift(g.pop());T(c);b(c).animate({rotate:e,left:0},{duration:m,easing:"easeOutExpo"});b(g[h- 1]).animate({rotate:"0deg",duration:m,easing:"easeOutExpo"});o&&clearTimeout(o);o=setTimeout(U,m)}})}function V(){var a=P(0);Q();R(b(g[h-1]).attr("id"));var c=Math.random()*(S-s)+s+"deg",e=Math.random()*(D-w)+w+"deg";i=="verticalAbove"||i=="verticalRound"?b(a).animate({rotate:c,top:i=="verticalRound"?E:-E},{duration:t,easing:"easeOutCubic",complete:function(){ba(a,e)}}):b(a).animate({rotate:c,left:i=="horizontalLeft"?-u:u},{duration:t,easing:"easeOutCubic",complete:function(){ca(a,e)}})}function ba(a, c){g.push(g.shift());W(a);b(g[h-2]).animate({rotate:c,duration:m,easing:"easeOutExpo"});b(a).animate({rotate:0,top:0},{duration:m,easing:"easeOutExpo",complete:function(){x(b(a).attr("id"))}})}function ca(a,c){g.push(g.shift());W(a);b(g[h-2]).animate({rotate:c,duration:m,easing:"easeOutExpo"});b(a).animate({rotate:0,left:0},{duration:m,easing:"easeOutExpo",complete:function(){x(b(a).attr("id"))}})}function U(){o&&clearTimeout(o);x(b(g[h-1]).attr("id"))}function R(a){if(g[a].captions!=void 0)for(var c= 0,a=g[a].captions,e=a.length,f;c<e;c++)f=b(a[c]),f.stop().animate({width:0},{duration:F,easing:"easeOutQuint"})}function x(a){if(g[a].captions!=void 0)for(var c=0,e=g[a].captions,f=e.length,h,d;c<f;c++)h=b(e[c]),d=e[c].finalInfoWidth,c!=f-1?h.delay(X*c).animate({width:d},{duration:F,easing:"easeOutQuint"}):c==f-1&&h.delay(X*c).animate({width:d},{duration:F,easing:"easeOutQuint",complete:function(){g[a].hasLink==void 0&&(b(g[a]).bind("click",A),b(g[a]).css("cursor","pointer"));r("on");j=!1;Y()}}); else b(g[a]).bind("click",A),b(g[a]).css("cursor","pointer"),r("on"),j=!1,Y()}function Y(){n&&!G&&(k.stop().animate({height:0},{duration:q,easing:"linear",complete:H}),l.stop().animate({height:0},{duration:q,easing:"linear"}))}function H(){j=!0;r("off");v=="forward"?B():V();k.animate({height:p},{duration:500,easing:"easeOutExpo"});l.animate({height:p},{duration:500,easing:"easeOutExpo"})}function C(){k.stop();l.stop();k.animate({height:p},{duration:500,easing:"easeOutExpo"});l.animate({height:p}, {duration:500,easing:"easeOutExpo"})}function r(a){a=="on"?(I.css("cursor","pointer"),J.css("cursor","pointer")):(I.css("cursor","default"),J.css("cursor","default"))}function K(a){if(!a)a=window.event;a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation();a=b(a.currentTarget).attr("id");if(a=="slide_prev"){if(j)return;j=!0;r("off");V();C()}else if(a=="slide_toggle")n?(n=!1,k.stop(),l.stop(),y.css("display","block"),z.css("display","none")):(n=!0,y.css("display","none"),z.css("display","block"), j||(a=k.height()/p*q,a<0&&(a=0),k.stop().animate({height:0},{duration:a,easing:"linear",complete:H}),l.stop().animate({height:0},{duration:a,easing:"linear"})));else if(a=="slide_next"){if(j)return;j=!0;r("off");B();C()}return!1}function T(a){b(a).css("zIndex",0);b(a).attr("id",0);for(var a=1,c;a<h;a++)c=b(g[a]),c.attr("id",a),c.css("zIndex",a)}function W(a){b(a).css("zIndex",h-1);b(a).attr("id",h-1);for(var a=0,c;a<h-1;a++)c=b(g[a]),c.attr("id",a),c.css("zIndex",a)}function da(){}b.browser.msie&& parseInt(b.browser.version,10);var n=d.slideshowOn,q=d.slideshowDelay,Z=b("#sliderHolder"),L=b("#sliderImages"),M=L.find("ul").find("li img"),g=[],N=[],$=b(M[0]).attr("width"),aa=b(M[0]).attr("height");b(M).each(function(){N.push(b(this).attr("src"))});var h=N.length,j=!1,o,t=d.upPartDuration,m=d.downPartDuration,s=d.maxRandomUpAngle,S=d.minRandomUpAngle,w=d.maxRandomDownAngle,D=d.minRandomDownAngle,ea=d.useControls,i=d.slideshowLayout;i!="horizontalLeft"&&i!="horizontalRight"&&i!="verticalAbove"&& i!="verticalRound"&&(i=verticalRound);var v=d.slideshowDirection;v!="forward"&&v!="backward"&&(v="forward");var X=d.captionOpenDelay,F=d.captionToggleSpeed,E=parseInt(aa,10)+100,u=parseInt($,10)+50,p=b("#playimg").height(),O=b("#slideControls"),I=b("#slide_prev"),d=b("#slide_toggle"),J=b("#slide_next");I.bind("click",K);d.bind("click",K);J.bind("click",K);O.css("opacity",0);var z=b("#pause_icon"),y=b("#play_icon"),k=b("#pause_icon2"),l=b("#play_icon2");y.css("display","none");z.css("display","none"); n?z.css("display","block"):y.css("display","block");var G=!1;Z.mouseenter(function(){G=!0;!j&&n&&(k.stop(),l.stop())}).mouseleave(function(){G=!1;if(!j&&n){var a=k.height()/p*q;a<0&&(a=0);k.stop().animate({height:0},{duration:a,easing:"linear",complete:H});l.stop().animate({height:0},{duration:a,easing:"linear"})}});setTimeout(function(){for(var a,c=0,e,f,d,j,i,m,k,o,l,n,p,s,t,u,q,v=b("#fontMeasure");c<h;c++){a=b("<div></div>");a.css("display","none");a.attr("id",c);a.attr("class","imageHolder"); a.css("zIndex",c);a.css("top",Math.random()*35);a.css("left",Math.random()*25);e=Math.random()*(D-w)+w;Z.append(a);c!=h-1&&a.css({rotate:e+"deg"});e=new Image;e=b(e);e.attr("id",c);e.css("position","relative");e.css("width",$);e.css("height",aa);e.css("display","block");e.appendTo(a);k=1;o=L.find("ul:eq("+c+")").find("li").size();for(q=[];k<o;k++){f=L.find("ul:eq("+c+")").find("li:eq("+k+")");j=f.css("backgroundColor");d=f.css("color");i=f.attr("class");m=i.substring(0,i.indexOf(","));i=i.substring(i.indexOf(",")+ 1);f=f.html();if(f.indexOf("href")!=-1)a.hasLink=!0;f=b("<div />").html(f).addClass("caption").appendTo(v);l=b(f).width()+1;n=b(f).height()+1;p=parseInt(b(f).css("paddingLeft"),10);s=parseInt(b(f).css("paddingRight"),10);t=parseInt(b(f).css("paddingTop"),10);u=parseInt(b(f).css("paddingBottom"),10);l=l+p+s;n=n+t+u;f.css("width",l);f.css("height",n);f.css("color",d);d=b("<div />").addClass("infoHolder");f.appendTo(d);d.finalInfoWidth=l;d.css("width",0);d.css("height",n);d.css("left",parseInt(m,10)); d.css("top",parseInt(i,10));d.css("background",j);d.appendTo(a);q.push(d)}if(o>1)a.captions=q;g.push(a);a=N[c]+"?rand="+Math.random()*99999999;b(e).load(function(){var a=b(this).attr("id"),c=b(g[a]);c.css("opacity",0);c.css("display","block");a!=h-1?c.animate({opacity:1},{duration:1E3,easing:"easeOutSine"}):c.animate({opacity:1},{duration:1E3,easing:"easeOutSine",complete:function(){ea&&(O.css("display","block"),O.animate({opacity:1},{duration:500,easing:"easeOutSine"}),r("on"));x(a);v.remove()}})}).attr("src", a);b(e).error(function(a){console.log("image load error "+a)})}},1E3);b(window).resize(function(){clearTimeout(this.id);this.id=setTimeout(da,500)})}})(jQuery);